---
import BaseLayout from "../layouts/base-layout.astro";
import Navbar from "../components/layout/navbar.astro";
import Sidebar from "../components/layout/sidebar.astro";
import DashboardStats from "../components/dashboard/dashboard-stats";
import ServiceToggle from "../components/services/service-toggle";
import { getUserFromCookies } from "../lib/auth";

const user = getUserFromCookies(Astro.cookies);
if (!user) return Astro.redirect("/login");
---

<BaseLayout title="Dashboard â€“ ServerPilot">
	<Sidebar />
	<div class="flex flex-1 flex-col md:ml-64">
		<Navbar username={user.username} />

		<main class="flex-1 p-4 pb-20 md:p-6 md:pb-6">
			<!-- Page heading -->
			<div class="mb-6">
				<h1 class="text-2xl font-bold tracking-tight">Dashboard</h1>
				<p class="mt-1 text-sm text-gray-500">
					Real-time server overview
				</p>
			</div>

			<!-- Live system stats (React island) -->
			<DashboardStats client:load />

			<!-- Quick Actions -->
			<div class="mt-8">
				<h2 class="mb-4 text-lg font-semibold">Quick Actions</h2>
				<div
					class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"
				>
					<a
						href="/docker"
						class="glass-card flex items-center gap-3 transition hover:border-accent/30"
					>
						<div
							class="flex h-10 w-10 items-center justify-center rounded-xl bg-blue-500/10"
						>
							<svg
								class="h-5 w-5 text-blue-400"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
								stroke-width="2"
							>
								<path
									d="M21 8c-1.45 0-2.26.15-3 .5-1.12-1.28-2.7-2-4.5-2h-3c-1.8 0-3.38.72-4.5 2C5.26 8.15 4.45 8 3 8c-1 0-1 2 0 2 .6 0 1 .1 1.4.3C4.15 11.4 4 12.6 4 14c0 3.32 2.68 6 6 6h4c3.32 0 6-2.68 6-6 0-1.4-.15-2.6-.4-3.7.4-.2.8-.3 1.4-.3 1 0 1-2 0-2z"
								></path>
							</svg>
						</div>
						<div>
							<p class="text-sm font-semibold">Docker</p>
							<p class="text-xs text-gray-500">
								Manage containers
							</p>
						</div>
					</a>
					<a
						href="/system"
						class="glass-card flex items-center gap-3 transition hover:border-accent/30"
					>
						<div
							class="flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-500/10"
						>
							<svg
								class="h-5 w-5 text-emerald-400"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
								stroke-width="2"
							>
								<rect x="2" y="3" width="20" height="14" rx="2"
								></rect><path d="M8 21h8m-4-4v4"></path>
							</svg>
						</div>
						<div>
							<p class="text-sm font-semibold">System</p>
							<p class="text-xs text-gray-500">Server details</p>
						</div>
					</a>
					<a
						href="/settings"
						class="glass-card flex items-center gap-3 transition hover:border-accent/30"
					>
						<div
							class="flex h-10 w-10 items-center justify-center rounded-xl bg-yellow-500/10"
						>
							<svg
								class="h-5 w-5 text-yellow-400"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
								stroke-width="2"
							>
								<circle cx="12" cy="12" r="3"></circle><path
									d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72 1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
								></path>
							</svg>
						</div>
						<div>
							<p class="text-sm font-semibold">Settings</p>
							<p class="text-xs text-gray-500">Configuration</p>
						</div>
					</a>
					<a
						href="/logs"
						class="glass-card flex items-center gap-3 transition hover:border-accent/30"
					>
						<div
							class="flex h-10 w-10 items-center justify-center rounded-xl bg-purple-500/10"
						>
							<svg
								class="h-5 w-5 text-purple-400"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
								stroke-width="2"
							>
								<path
									d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
								></path><path d="M14 2v6h6"></path><path
									d="M16 13H8m8 4H8m2-8H8"></path>
							</svg>
						</div>
						<div>
							<p class="text-sm font-semibold">Logs</p>
							<p class="text-xs text-gray-500">Service logs</p>
						</div>
					</a>
				</div>
			</div>
		</main>
	</div>
</BaseLayout>
