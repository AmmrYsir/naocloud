---
/**
 * audit.astro – Audit logs page
 */
import BaseLayout from "../layouts/base-layout.astro";
import Navbar from "../components/layout/navbar.astro";
import Sidebar from "../components/layout/sidebar.astro";
import AuditLogViewer from "../components/security/audit-log-viewer";
import { getUserFromCookies } from "../lib/auth";

const user = getUserFromCookies(Astro.cookies);
if (!user || user.role !== "admin") return Astro.redirect("/login");
---

<BaseLayout title="Audit Logs – ServerPilot">
	<Sidebar />
	<div class="flex flex-1 flex-col md:ml-64">
		<Navbar username={user.username} />

		<main class="flex-1 p-4 pb-20 md:p-6 md:pb-6">
			<div class="mb-6">
				<h1 class="text-2xl font-bold tracking-tight">Audit Logs</h1>
				<p class="mt-1 text-sm text-gray-500">
					View and export audit logs for all admin actions
				</p>
			</div>

			<AuditLogViewer client:load />
		</main>
	</div>
</BaseLayout>
